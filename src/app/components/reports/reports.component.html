<div style="padding:0.7em; background-color: #39623f !important;
                box-shadow: 0 4px 2px -2px rgba(0, 0, 0, 0.2); border: none !important;">
    <h5 style="font-weight: bold;font-family: auto;text-align: left;color: #fff;">Expense Tracker (Reports)</h5>
    <div class="row">
        <!-- <div class="col-6">
            <span style="color:#6d9773;  border-radius: 5px;">Reports</span>
        </div>
        <div class="col-6">
            <button type="button" style="float: right;background-color: #6d9773;" class="btn"
                (click)="filterOn = !filterOn"><i class="fa fa-filter">
                    <span style="margin-left:5px">Add Filter</span></i>
            </button>
        </div> -->

        <form [formGroup]="filterForm" (ngSubmit)="applyFilters()">
            <div style="text-align: center;margin-top:1em" class="row">
                <div class="col-5">
                    <select class="form-select" formControlName="filterMonth">
                        <option *ngFor="let month of months" [ngValue]="month">
                            {{month}}</option>
                    </select>
                </div>
                <div class="col-5">
                    <select class="form-select" formControlName="filterYear">
                        <option *ngFor="let year of years" [ngValue]="year">
                            {{year}}</option>
                    </select>
                </div>
                <div class="col-2">
                    <button type="submit" class="btn" style="background: #6d9773;"><i class="fa fa-search">
                            <span style="margin-left:5px"></span></i>
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- <ul>
        <li>Total Monthly View (Monthly income vs monthly exp)</li>
        <li>Category View (Each item vs target)</li>
        <li>Umbrella View (Each item vs target)</li>
        <li>Month on Month</li>
    </ul> -->
<div class="container row" style="margin-top: 0.5em !important;margin: auto;">
    <button class="col-3 reportBtn" (click)="showReport('overview')"
        [ngStyle]="{'background': overviewFlag ? '#fff':'#6d9773', 'color': overviewFlag ? '#6d9773':'#fff', 'border-left': overviewFlag ? '1px solid #6d9773':'1px solid #fff'}">
        Overview
    </button>
    <button class="col-3 reportBtn" (click)="showReport('monthly')"
        [ngStyle]="{'background': monthlyFlag ? '#fff':'#6d9773', 'color': monthlyFlag ? '#6d9773':'#fff'}">
        Monthly
    </button>
    <button class="col-3 reportBtn" (click)="showReport('target')"
        [ngStyle]="{'background': targetFlag ? '#fff':'#6d9773', 'color': targetFlag ? '#6d9773':'#fff'}">
        Targets
    </button>
    <button class="col-3 reportBtn" (click)="showReport('trend')"
        [ngStyle]="{'background': trendFlag ? '#fff':'#6d9773', 'color': trendFlag ? '#6d9773':'#fff', 'border-right': trendFlag ? '1px solid #6d9773':'1px solid #fff'}">
        Trends
    </button>
</div>

<div *ngIf="overviewFlag" style="margin-top: 5em;" class="container">
    <span class="row" style="padding: 0.5em; text-align: center;background:#39623f;color:#fff">
        <h1>Total Income</h1>
    </span>
    <span class="row" style="padding: 0.5em; text-align: center"
        [ngStyle]="{'color': overview.totalDeviation > 0 ? 'green':'red'}">
        <h2>{{overview.totalBudget | number:'1.2-2'}}</h2>
    </span>
    <span class="row" style="padding: 0.5em; text-align: center;background:#39623f;color:#fff">
        <h1>Total Expense</h1>
    </span>
    <span class="row" style="padding: 0.5em; text-align: center"
        [ngStyle]="{'color': overview.totalDeviation > 0 ? 'green':'red'}">
        <h2>{{overview.totalExpense | number:'1.2-2'}}</h2>
    </span>
    <span class="row" style="padding: 0.5em; text-align: center;background:#39623f;color:#fff">
        <h1>Total Margin</h1>
    </span>
    <span class="row" style="padding: 0.5em; text-align: center"
        [ngStyle]="{'color': overview.totalDeviation > 0 ? 'green':'red'}">
        <h2>{{overview.totalDeviation | number:'1.2-2'}}</h2>
    </span>
</div>

<div *ngIf="monthlyFlag" class="table-container">
    <table class="table table-striped table-responsive table-bordered" style="background: none;">
        <thead>
            <tr>

                <th style="width:20%">Parent</th>
                <th style="width:20%">Category</th>
                <th style="width:18%">Budget</th>
                <th style="width:20%">Expense</th>
                <td style="width:20%">Deviation</td>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let monthlyView of responseList; let i=index">
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.parent}}</td>
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.category}}</td>
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.budget}}</td>
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.expense}}</td>
                <td
                    [ngStyle]="{'color': monthlyView.deviate == 0 ? 'black': (monthlyView.deviate < 0) ? 'red' : 'green',
                    'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">
                    {{monthlyView.deviate}}
                </td>
            </tr>
            <tr>
                <td colspan="2" style="background-color: #6d9773 !important;font-weight: bold;">Total</td>
                <td style="background-color: #6d9773 !important;font-weight: bold;">{{monthlyBudgetTotal}}</td>
                <td style="background-color: #6d9773 !important;font-weight: bold;">{{monthlyExpenseTotal |
                    number:'1.2-2'}}</td>
                <td style="background-color: #6d9773 !important;font-weight: bold;"
                    [ngStyle]="{'color': monthlyDeviateTotal == 0 ? 'black': (monthlyDeviateTotal < 0) ? 'red' : 'green'}">
                    {{monthlyDeviateTotal | number:'1.2-2'}}</td>
            </tr>
        </tbody>
    </table>
</div>

<div *ngIf="targetFlag" class="table-container">
    <table class="table table-striped table-responsive table-bordered" style="background: none;">
        <thead>
            <tr>
                <th style="width:30%">Category</th>
                <th style="width:30%">Budget</th>
                <th style="width:30%">Expense</th>
                <td style="width:20%">Deviation</td>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let targetView of responseList; let i=index">
                <td>
                    <a style="text-decoration: underline;cursor: pointer;"
                        (click)="openDialog(targetView.parent, 'fetch-target-details', 100, 100)">{{targetView.parent}}</a>
                </td>
                <td>{{targetView.budget}}</td>
                <td>{{targetView.expense}}</td>
                <td
                    [ngStyle]="{'color': targetView.deviate == 0 ? 'black': (targetView.deviate < 0) ? 'red' : 'green'}">
                    {{targetView.deviate}}
                </td>
            </tr>
            <tr>
                <td style="background-color: #6d9773 !important;font-weight: bold;">Total</td>
                <td style="background-color: #6d9773 !important;font-weight: bold;">{{targetBudgetTotal |
                    number:'1.2-2'}}</td>
                <td style="background-color: #6d9773 !important;font-weight: bold;">{{targetExpenseTotal |
                    number:'1.2-2'}}</td>
                <td style="background-color: #6d9773 !important;font-weight: bold;"
                    [ngStyle]="{'color': targetDeviateTotal == 0 ? 'black': (targetDeviateTotal < 0) ? 'red' : 'green'}">
                    {{targetDeviateTotal | number:'1.2-2'}}</td>
            </tr>
        </tbody>
    </table>
</div>


<div *ngIf="trendFlag" class="table-container">
    <table class="table table-striped table-responsive table-bordered" style="background: none;">
        <thead>
            <tr>

                <th style="width:20%">Month</th>
                <th style="width:20%">Budget</th>
                <th style="width:18%">Expense</th>
                <th style="width:20%">Deviate</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let monthlyView of responseList; let i=index">
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.month}}</td>
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.totalBudget | number:'1.2-2'}}</td>
                <td  [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">{{monthlyView.totalExpense | number:'1.2-2'}}</td>
                <td
                    [ngStyle]="{'color': monthlyView.deviate == 0 ? 'black': (monthlyView.deviate < 0) ? 'red' : 'green',
                    'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">
                    {{monthlyView.deviate | number:'1.2-2'}}
                </td>
            </tr>
        </tbody>
    </table>
</div>