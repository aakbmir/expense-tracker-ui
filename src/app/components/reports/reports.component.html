<div class="container-fluid" style="margin:auto; background-color: #1c2125 !important; height:14em; padding-top:2em">
    <h5 style="font-size: 30px; font-family:math; color: #fff;">Dashboard
        <button type="button" style="float: right;" class="btn" (click)="filterOn = !filterOn"><i class="fa fa-filter"
                style="color: #fff;"></i>
        </button>
    </h5>
    <div class="row" *ngIf="filterOn">
        <form [formGroup]="filterForm" (ngSubmit)="applyFilters()">
            <div style="text-align: center; margin-top:1em" class="row">
                <div class="col-5">
                    <select class="form-select" formControlName="filterMonth">
                        <option *ngFor="let month of months" [ngValue]="month">
                            {{month}}</option>
                    </select>
                </div>
                <div class="col-5">
                    <select class="form-select" formControlName="filterYear">
                        <option *ngFor="let year of years" [ngValue]="year">
                            {{year}}</option>
                    </select>
                </div>
                <div class="col-2">
                    <button type="submit" class="btn" style="background: #6d9773;"><i class="fa fa-search">
                            <span style="margin-left:5px"></span></i>
                    </button>
                </div>
            </div>
        </form>
    </div>
    <br />
    <div class="card" style="padding:0.7em; padding-top:1em; color:#fff; text-align: center; border-radius: 20px; height:15em;
         background: url(data:image/jpg;base64,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) no-repeat 0 0 #141819">
        <h4>Total Savings</h4>
        <h1 [ngStyle]="{'color': overview.totalDeviation > 0 ? '#8cff8c':'red'}">{{overview.totalDeviation|
            number:'1.2-2'}} د.إ</h1>
        <div class="card-body row">
            <div class="col-6" style="text-align: left;">
                <h4>Income</h4>
                <h5 [ngStyle]="{'color': overview.totalDeviation > 0 ? '#8cff8c':'red'}">{{overview.totalBudget|
                    number:'1.2-2'}} د.إ</h5>
            </div>
            <div class="col-6" style="text-align: right;">
                <h4>Expense</h4>
                <h5 [ngStyle]="{'color': overview.totalDeviation > 0 ? '#8cff8c':'red'}">{{overview.totalExpense|
                    number:'1.2-2'}} د.إ</h5>
            </div>
        </div>
        {{month}}/{{year}}
    </div>
</div>
<br/><br/><br/><br/><br/>
<div class="container row" style="margin-top: 0.5em !important; margin: auto;">
    <button class="col-3 reportBtn" (click)="showReport('overview')"
        [ngStyle]="{'color': overviewFlag ? '#6d9773':'dimgrey'}">
        <i class="fa fa-tachometer fa-2x"></i>
    </button>
    <button class="col-3 reportBtn" (click)="showReport('monthly')"
        [ngStyle]="{'color': monthlyFlag ? '#6d9773':'dimgrey'}">
        <i class="fa fa-modx fa-2x"></i>
    </button>
    <button class="col-3 reportBtn" (click)="showReport('target')"
        [ngStyle]="{'color': targetFlag ? '#6d9773':'dimgrey'}">
        <i class="fa fa-yelp fa-2x"></i>
    </button>
    <button class="col-3 reportBtn" (click)="showReport('trend')"
        [ngStyle]="{'color': trendFlag ? '#6d9773':'dimgrey'}">
        <i class="fa fa-line-chart fa-2x"></i>
        
    </button>
</div>

<div *ngIf="overviewFlag" style="margin-top: 2em;" class="container">
    <div class="row" style="text-align: center; margin-top: 1em">
        <div class="col-2"></div>
        <div class="col-8">
            <select class="form-select" [(ngModel)]="selectedCategory" (change)="fetchTransactions()">
                <option *ngFor="let month of categoryList" [ngValue]="month">
                    {{month}}</option>
            </select>
        </div>
        <div class="col-2"></div>
        <div class="report-container" style="margin-top:0.5em">
            <div *ngFor="let item of categoryTransactionList"
                style="padding:0.2em; margin:auto; width:100%; margin-top: 1em">
                <button class="row" (click)="openDialog(item.parent, 'fetch-parent-details', 100, 100)"
                    style="width: 100%; padding-top: 0.5em; border: none; background-color: #eceae875; border-radius: 10px; margin:auto"
                    [ngStyle]="{'margin-bottom': categoryTransactionList.length > 0 ? '0.3em': '0px'}">
                    <div class="col-6" style="text-align: left;">
                        <h5 style="color: #6d9773">{{item.category}}</h5>
                        <h6 style="margin-bottom:0; color:dimgrey;">{{item.note}}
                        </h6>
                    </div>
                    <div class="col-6" style="text-align: right;">
                        <h6 style="color: dimgrey">
                            {{item.date | date : 'MMM dd, EEEE'}}
                        </h6>
                        <h5 style="color: '#6d9773'">
                            {{item.price | number:'1.2-2'}}
                            <small style="font-size: 0.475em">AED</small>
                        </h5>
                    </div>
                </button>
            </div>
        </div>
    </div>
</div>
<div *ngIf="monthlyFlag" class="table-container" style="margin-left:0.1em; margin-right:0.1em">
    <div *ngFor="let group of groupedDataArray" style="padding:0.5em; margin:0.3em; margin-bottom: 1em;">
        <h4 style="color: #6d9773;">{{ group.parent}}</h4>
        <div *ngFor="let item of group.items">
            <button class="row" (click)="openDialog(item.category, 'fetch-monthly-details', 100, 100)"
                style="width: -webkit-fill-available; padding-top: 0.5em; border: none; background-color: #eceae875; border-radius: 10px;"
                [ngStyle]="{'margin-bottom': group.items.length > 0 ? '0.3em': '0px'}">
                <div class="col-6" style="text-align: left;">
                    <h5 style="color: #6d9773">{{item.category}}</h5>
                    <h6 style="margin-bottom:0; color:dimgrey;">{{item.budget | number:'1.2-2'}}
                        <small style="font-size: 0.475em">AED</small>
                    </h6>
                </div>
                <div class="col-6" style="text-align: right;">
                    <h6 [ngStyle]="{'color': (item.expense == 0 || item.expense > item.budget) ? 'red':  'dimgrey'}">
                        {{item.expense | number:'1.2-2'}}
                        <small style="font-size: 0.475em">AED</small>
                    </h6>
                    <h5 [ngStyle]="{'color': item.deviate >= 0 ? '#6d9773':  'red'}">
                        {{item.deviate | number:'1.2-2'}}
                        <small style="font-size: 0.475em">AED</small>
                    </h5>
                </div>
            </button>
        </div>
    </div>
</div>

<div *ngIf="targetFlag" class="table-container" style="padding-top:1em">
    <div *ngFor="let item of responseList" style="padding:0.2em; margin:auto; width:100%;">
        <button class="row" (click)="openDialog(item.parent, 'fetch-parent-details', 100, 100)"
            style="width: 100%; padding-top: 0.5em; border: none; background-color: #eceae875; border-radius: 10px; margin:auto"
            [ngStyle]="{'margin-bottom': responseList.length > 0 ? '0.3em': '0px'}">
            <div class="col-6" style="text-align: left;">
                <h5 style="color: #6d9773">{{item.parent}}</h5>
                <h6 style="margin-bottom:0; color:dimgrey;">{{item.budget | number:'1.2-2'}}
                    <small style="font-size: 0.475em">AED</small>
                </h6>
            </div>
            <div class="col-6" style="text-align: right;">
                <h6 [ngStyle]="{'color': item.expense === 0 || item.expense > item.budget ? 'red':  'dimgrey'}">
                    {{item.expense | number:'1.2-2'}}
                    <small style="font-size: 0.475em">AED</small>
                </h6>
                <h5 [ngStyle]="{'color': item.deviate >= 0 ? '#6d9773':  'red'}">
                    {{item.deviate | number:'1.2-2'}}
                    <small style="font-size: 0.475em">AED</small>
                </h5>
            </div>
        </button>
    </div>
    <!--     
    <table class="table table-striped table-responsive table-bordered" style="background: none;">
        <thead>
            <tr>
                <th style="width:30%">Category</th>
                <th style="width:30%">Budget</th>
                <th style="width:30%">Expense</th>
                <td style="width:20%">Deviation</td>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let targetView of responseList; let i=index">
                <td>
                    <a style="text-decoration: underline; cursor: pointer;"
                        (click)="openDialog(targetView.parent, 'fetch-parent-details', 100, 100)">{{targetView.parent}}</a>
                </td>
                <td>{{targetView.budget}}</td>
                <td>{{targetView.expense}}</td>
                <td
                    [ngStyle]="{'color': targetView.deviate == 0 ? 'black': (targetView.deviate < 0) ? 'red' : 'green'}">
                    {{targetView.deviate}}
                </td>
            </tr>
            <tr>
                <td style="background-color: #6d9773 !important; font-weight: bold;">Total</td>
                <td style="background-color: #6d9773 !important; font-weight: bold;">{{targetBudgetTotal |
                    number:'1.2-2'}}</td>
                <td style="background-color: #6d9773 !important; font-weight: bold;">{{targetExpenseTotal |
                    number:'1.2-2'}}</td>
                <td style="background-color: #6d9773 !important; font-weight: bold;"
                    [ngStyle]="{'color': targetDeviateTotal == 0 ? 'black': (targetDeviateTotal < 0) ? 'red' : 'green'}">
                    {{targetDeviateTotal | number:'1.2-2'}}</td>
            </tr>
        </tbody>
    </table> -->
</div>


<div *ngIf="trendFlag" class="table-container">
    <table class="table table-striped table-responsive table-bordered" style="background: none;">
        <thead>
            <tr>
                <th style="width:20%">Month</th>
                <th style="width:20%">Budget</th>
                <th style="width:18%">Expense</th>
                <th style="width:20%">Deviate</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let monthlyView of responseList; let i=index">
                <td [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">
                    {{monthlyView.month}}
                </td>
                <td [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">
                    {{monthlyView.totalBudget | number:'1.2-2'}}</td>
                <td [ngStyle]="{'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">
                    {{monthlyView.totalExpense | number:'1.2-2'}}</td>
                <td [ngStyle]="{'color': monthlyView.deviate == 0 ? 'black': (monthlyView.deviate < 0) ? 'red' : 'green',
                    'background-color': monthlyView.deviate == 0 ? '#fafacd':  ''}">
                    {{monthlyView.deviate | number:'1.2-2'}}
                </td>
            </tr>
        </tbody>
    </table>
</div>